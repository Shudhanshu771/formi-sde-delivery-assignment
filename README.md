# ğŸ¨ Formi SDE Delivery Assignment

## âœ… Overview

This project implements a **voice AI-compatible backend API system** for Formi Resorts to support:

* Room availability/enquiry APIs under 800-token limits
* Natural language-based query resolution
* Google Sheets logging after calls

Built entirely using **FastAPI** with modular support for `.csv` knowledge base parsing.

---

## âš™ï¸ Tech Stack

| Purpose                   | Tech                          |
| ------------------------- | ----------------------------- |
| Web Framework             | FastAPI                       |
| Google Sheets Integration | `gspread`, `oauth2client`     |
| Data Source               | `.csv` files                  |
| Deployment                | Localhost                     |
| Token Management          | Slicing + Filtering           |

---

## ğŸ›  Project Structure

```
sde-delivery-assignment/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py                # FastAPI app with all routes
â”œâ”€â”€ data/                      # CSV files used as data source
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â””â”€â”€ requirements.txt
```

---

## ğŸ”‘ Features Implemented

### ğŸ” /query Endpoint

* **Purpose**: Parse natural queries like "indoor activities in Sterling Kodai Lake"
* **Response**: Filtered JSON results from the relevant `.csv` file
* **Safe for AI use**: Only returns \~5 rows max with `fillna('NA')`
* **Token-safe**

### ğŸ§¾ /log-to-sheet Endpoint

* **Purpose**: Log call summary to Google Sheets
* **Data Logged**:

  * Call time
  * Phone number
  * Outcome (Enquiry, Booking, etc.)
  * Customer details (name, check-in/out, etc.)
  * Call summary
* **Google API used**: `gspread`

---

## ğŸ“¤ Sample Request: `/query`

```json
{
  "query": "indoor activities in Sterling Kodai Lake"
}
```

### âœ… Sample Response

```json
[
  {
    "primary_name": "Sterling Kodai Lake",
    "Type": "Indoor",
    "GAMES": "Table Tennis",
    "CHARGESPERPERSON": "NA",
    "DURATION": "NA",
    "ANYOutdoorINFORMATION": "They can play singles and doubles also",
    "MINMAXCAPONNUMBEROFGUESTS": "Min 2/Max 4"
  },
  ...
]
```

---

## ğŸ§¾ Sample Request: `/log-to-sheet`

```json
{
  "call_time": "2025-01-03 12:50:07",
  "phone_number": "9833620578",
  "call_outcome": "ROOM_AVAILABILITY",
  "customer_name": "Padmeet",
  "room_name": "Executive Room",
  "check_in": "2025-01-03",
  "check_out": "2025-01-04",
  "guests": 2,
  "call_summary": "User asked about room availability for Executive Room at Kemps Corner Hotel. Wants to book for 2 people."
}
```
<img width="1561" height="99" alt="image" src="https://github.com/user-attachments/assets/43ebf587-c47a-4d63-8279-c150cc04dcce" />

---

## ğŸ“¦ Installation & Run Locally

```bash
git clone https://github.com/Shudhanshu771/formi-sde-delivery-assignment.git
cd formi-sde-delivery-assignment
python -m venv venv
source venv/bin/activate  # or venv\Scripts\activate on Windows
pip install -r requirements.txt
uvicorn app.main:app --reload
```

---

## ğŸ“Œ Notes

* All `.csv` files are kept in `/data/`
* `.gitignore` blocks `*.json`, `*.csv`, and sensitive files
* `.env` or `creds.json` is **NOT included** â€” must be generated by user manually from GCP Console

## ğŸ™Œ Conclusion

This project demonstrates:

* Natural language query resolution
* Token-safe API architecture
* Real-time logging to Google Sheets

Ready for integration with **Retell AI agents** and real-time environments âœ…
